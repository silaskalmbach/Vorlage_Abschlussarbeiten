% ============= Einstellungen zur Arbeit =============
\documentclass[fontsize=11pt]{scrartcl}

% ============= Einstellungen zum Kompilieren =============

\def\tikzextern{0} % 0 = Nein; 1 = Ja (TikZ Grafiken extern Speichern)
\def\mintedinstall{0} % 0 = Nein; 1 = Ja; Um Minted zu nutzen muss Python und Pygments installiert sein. Alternative: listings

% Variablen einbinden
\input{_E_ressources/variables}
%
%% Preambel einbinden
\input{_E_ressources/preambel}   
%
% % Zeilenabstand zurücksetzen
\setstretch{1.00}

% ============= Farbschema =============

\usepackage[%
    paperheight=\bookCoverHeight mm,
    paperwidth=\bookCoverWidth mm,
    margin=0 mm,
%    heightrounded,
%    showframe
    ]{geometry}

% begin the document and suppress page numbers
\begin{document}

\pagestyle{empty} 

\setlength{\parindent}{0pt} %Wenn Absatzabstand, dann Einzug unnötig
\setlength{\parskip}{7pt} %Absatzabstand

% Update graphicspath to image folder
%\graphicspath{{./}}

\begingroup%
    \makeatletter%
    % Conversion of pt to mm
    % #1: macro, which gets the result of the conversion without unit
    % #2: length expression
    \newcommand*{\converttomm}[2]{%
      \edef#1{%
        \strip@pt\dimexpr(#2)*2540/7227\relax % 72.27 pt = 1 in = 25.4 mm
      }%
    }
    \makeatother%
    
    % Folgende Maßeinheiten in mm
    \setlength{\unitlength}{1mm}
    
    \noindent\begin{picture}(\bookCoverWidth,\bookCoverHeight)(0,0)
        \converttomm{\fiveBaselineskip}{5.25\baselineskip}%
        
        % Prinzipielle Strategie: Mittels \put{x,y} [ab Eckpunkt unten links, Angaben in mm] die untere Linke Ecke einer Box erstellen. 
        % Mittels \makebox(Breite,Höhe) eine Box zwischen den Hilfslinien erstellen. Kann bspw. mit \framebox angezeigt werden.
        % In der Box dann Text und Bilder vertikal zentriert ausrichten
        % Die Positions ist abhängig von der Dicke des Buchrückens gesetzt (Siehe x-Koordinaten)

        % ILEK Logo Vorderseite
        \put(\numexpr\standardPageWidth + \spineWidth + 140\relax, 227){
        \makebox(0,45)[lc]{%
            \includegraphics[height=10mm]{ILEK-logo}
            }}

        % ILEK Logo Rückseite
        \put(28,227){
        \makebox(0,45)[lc]{%
            \includegraphics[height=10mm]{ILEK-logo}
            }}

        % Logo Uni Stuttgart und Beschriftung
        \put(\numexpr\standardPageWidth + \spineWidth + 20\relax,30){
        \makebox(0,25)[lc]{%
            \includegraphics[height=4.2\baselineskip]{unistuttgart_logo_de}
            }}
            
        \put(\numexpr\standardPageWidth + \spineWidth + 20\relax,30){% Position Text
        \put(\fiveBaselineskip,0){% 5x Texthöhe hinzufügen
        \makebox(0,25)[lc]{%
            \begin{tabular}{l}
                {\small \Institut} \\ 
                {\small \ProfEins} \\
                {\small \ProfZwei} \\
                {\small Universität Stuttgart}
            \end{tabular}
            }}}

        % Beschriftung des Buchrückens
        \put(\numexpr\standardPageWidth + \spineWidth / 2\relax, 42.5){% Position Text
            \rotatebox{90}{\makebox(0,0)[c]{
                \MakeUppercase{\EndeJahr~|~\NummerDerArbeit}
                }}
            }%
        
        \put(\numexpr\standardPageWidth + \spineWidth / 2\relax, 60.0){% Position Text
            \rotatebox{90}{\makebox(0,0)[l]{%
                \MakeUppercase{\StudentNachname\:-\:\TitelDerArbeit}
                }}
            }%
        
        \put(\numexpr\standardPageWidth + \spineWidth / 2\relax, 249.5){% Position Text
            \rotatebox{90}{\makebox(0,0)[c]{%
                \MakeUppercase{\TypDerArbeit}
                }}
            }%

        % Horizontale Linien hinzufügen
        \put(0,30){\color{uniSgrey}\rule{\textwidth}{1pt}}
        \put(0,55){\color{uniSgrey}\rule{\textwidth}{1pt}}
        \put(0,227){\color{uniSgrey}\rule{\textwidth}{1pt}}
        \put(0,272){\color{uniSgrey}\rule{\textwidth}{1pt}}
        
        % Hilfslinien für den Buchrücken, bei Bedarf einblenden
        % \put(\standardPageWidth,0){\rule{.4pt}{\paperheight}}
        % \put(\numexpr\spineWidth + \standardPageWidth\relax,0){\rule{.4pt}{\paperheight}}
        
        % Titel
        \doublespacing
        \put(\numexpr\standardPageWidth + \spineWidth + 20\relax, 55){% Position Text
        \makebox(0,172)[lc]{%
            % \begin{tabular}[t]{l{\baselineskip} l}
            \begin{tabular}{p{120mm}}  
                \textbf{{\LARGE \TitelDerArbeit}} \\ 
                \StudentVorname \: \StudentNachname \\
                \\ \\ 
                \TypDerArbeit\\
                \EndeMonat \: \EndeJahr
            \end{tabular}
            }}
        
    \end{picture}%
\endgroup%
\end{document}